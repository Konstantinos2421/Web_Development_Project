<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Login</title>
        <link rel="stylesheet" href="../../bootstrap-5.3.2-dist/css/bootstrap.css">
    </head>
    
    <style>
        html,body {
            height:100%;
            margin: 0;
        }
        
        .bg-image {
            background-image: url('../../imgs/img1.jpg');
            background-size: cover;
            height:100%;           
            background-position: top left;
        }
    </style>

    <body class="bg-image">
        <div class="container">
            <div class="row mt-5"></div>
        </div>

        <div class="container">
            <div class="row mt-5"></div>
        </div>

        <div class="container">
            <div class="row mt-5"></div>
        </div>

        <div class="container">
            <div class="row">
                <div class="col-lg-4 col-sm-12 bg-white rounded">
                    <img src="../../imgs/logo.png" class="img-thumbnail mt-3 mb-4" width="130" height="85" style="position:relative; left:50%; top:10%; transform:translate(-50%, -50%);">
                    <form>
                        <div class="mb-4 mt-3">
                            <label for="username" class="form-label">Username:</label>
                            <input type="text" class="form-control" placeholder="Enter Username" id="username_field">
                        </div>

                        <div class="mb-5 mt-3">
                            <label for="password" class="form-label">Password:</label>
                            <input type="password" class="form-control" placeholder="Enter Password" id="password_field">
                        </div>
                        
                        <div class="text-center"> 
                            <button type="button" class="btn btn-primary mb-5 btn-lg" id="login_btn">LOG IN</button>
                            <span class="mx-4"></span>
                            <button type="button" class="btn btn-success mb-5 btn-lg" id="signup_btn">SIGN UP</button>
                          </div>
                    </form>
                </div>
            </div>
        </div>


        <script>

            document.getElementById("login_btn").addEventListener('click', () => {
        
                username = document.getElementById('username_field').value;
                password = document.getElementById('password_field').value;

                fetch('http://localhost:3000/login/' + username + '/' + password, { method: 'POST' })
                .then(response => response.text())
                .then(data => {
                    if(data == 'Username not found'){
                        alert('Username not found');
                    }else if(data == 'Wrong password'){
                        alert('Wrong password');
                    }else{
                        sessionStorage.setItem('username', username);
                        sessionStorage.setItem('userType', data);
                        sessionStorage.setItem('loggedIn', 'yes');
                    
                        if(data == 'admin'){
                            window.location.href = '../../src/admin/admin_home.html';
                        }else if(data == 'rescuer'){
                            window.location.href = '../../src/rescuer/rescuer_home.htm';
                        }else if(data == 'citizen'){
                            window.location.href = '../../src/citizen/citizen_home.html';
                        }
                    }
                })
                .catch((error) => {
                    console.error('Error: ', error);
                });

            });

        </script>

    </body>
</html>