<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Display Inventory Status</title>
        <link rel="stylesheet" href="../../bootstrap-5.3.2-dist/css/bootstrap.css">
    </head>

    <body>
        <div class="container-fluid">
            <div class="row" style="background-color:rgb(80, 102, 80)">
              <div class="col-lg-5"></div>
      
              <div class="col-lg-2 mb-4">
                <img src="../../imgs/logo.png" class="img-thumbnail mt-4 mx-auto d-block" height="45" width="170">
              </div>
      
              <div class="col-lg-3"></div>
      
              <div class="col-lg-2 mt-4">
                <div class="btn-group">
                  <button type="button" class="btn btn-link">
                    <img alt src="../../imgs/home.png" class="img-thumbnail" width="45" height="45">
                  </button>
      
                  <button type="button" class="btn btn-link">
                    <img src="../../imgs/user.png" class="img-thumbnail" width="45" height="45">
                  </button>
      
                  <button type="button" class="btn btn-link">
                    <img alt src="../../imgs/power.png" class="img-thumbnail" width="45" height="45">
                  </button> 
                </div>  
              </div>
            </div>
        </div>

        <div class="container-fluid mt-4">
            <div class="row">

                <div class="col-lg-3">
                    <form class="border border-3 rounded-4 ps-4 pt-4" id="categoriesCheckboxes">
                        <p class="h3 text-center mb-4">Categories</p>
                    </form>
                </div>

                <div class="col-lg-6" id="categories_tables">

                </div>

            </div>
        </div>

    
    </body>

    <script>
         let admin = sessionStorage.getItem("username");

         fetch('http://localhost:3000/base/categories/stavros_paraskevopoulos')
         .then(response => response.json())
         .then(data => {

            data.forEach(item => {
                const div = document.createElement('div');
                div.className = "form-check mb-3";
                
                const input = document.createElement('input');
                input.type = "checkbox";
                input.className = "form-check-input";
                
                
                const label = document.createElement('label');
                label.className = "form-check-label";
                label.textContent = item.category_name;
                
                div.appendChild(input);
                div.appendChild(label);

                document.getElementById("categoriesCheckboxes").appendChild(div);

                input.addEventListener('change', function () {
                    if (input.checked) {
                        fetch('http://localhost:3000/displayBaseInventory/admin/stavros_paraskevopoulos/' + item.category_id)
                        .then(response => response.json())
                        .then(data => {
                 
                          const table = document.createElement('table');
                          table.className = "table table-bordered";
                          table.id = item.category_id;

                          const theads = document.createElement('theads');

                          const tr0 = document.createElement('tr');

                          const th1 = document.createElement('th');
                          th1.textContent = 'Product id';
                            
                          const th2 = document.createElement('th');
                          th2.textContent = 'Product Name';
                            
                          const th3 = document.createElement('th');
                          th3.textContent = 'Quantity';

                          const tbody = document.createElement('tbody');

                          table.appendChild(theads);
                          theads.appendChild(tr0);
                          tr0.appendChild(th1);
                          tr0.appendChild(th2);
                          tr0.appendChild(th3);

                          data.forEach(item => {
                            const tr = document.createElement('tr');

                            const td1 = document.createElement('td');
                            td1.textContent = item.product_id;

                            const td2 = document.createElement('td');
                            td2.textContent = item.product_name;

                            const td3 = document.createElement('td');
                            td3.textContent = item.total_quantity;

                            tr.appendChild(td1);
                            tr.appendChild(td2);
                            tr.appendChild(td3);
                            tbody.appendChild(tr);

                          });

                          document.getElementById("categories_tables").appendChild(table);
                          table.appendChild(tbody);

                          
                          
                        })
                        .catch(error => console.error('Error fetching category data:', error));
                        

                          
                    }
                    else {
                      const tableToRemove = document.getElementById(item.category_id);
                      if (tableToRemove) {
                        tableToRemove.parentNode.removeChild(tableToRemove);
                      }

                    }
                    


                });
                


            })
            .catch(error => console.error('Error fetching data:', error));

        });


    </script>


</html>